{% extends "base.html" %}

{% block content %}
<h2>Forum Threads</h2>

{% if active_tag %}
  <p>
    Showing threads tagged with <strong>#{{ active_tag.name }}</strong>
    | <a href="{% url 'thread_list' %}">Clear filter</a>
  </p>
{% endif %}

{% if user.is_authenticated %}
  <a href="{% url 'thread_create' %}">Create New Thread</a>
{% endif %}

<ul>
  {% for thread in page_obj %}
    <li>
      <a href="{% url 'thread_detail' thread.id %}">
        {{ thread.title }}
      </a>

      {% if thread.is_locked %}
        <strong>(Locked)</strong>
      {% endif %}

      <br>
      <small>
        By {{ thread.creator.email }} |
        {{ thread.created_at }}
      </small>

      {% if thread.tags.all %}
        <br>
        {% for tag in thread.tags.all %}
          <small>
            <a href="{% url 'threads_by_tag' tag.slug %}">
              #{{ tag.name }}
            </a>
          </small>
        {% endfor %}
      {% endif %}
    </li>
  {% empty %}
    <li>No threads yet.</li>
  {% endfor %}
</ul>
<div class="mt-3">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
  {% endif %}

  <span>
    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
  </span>

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}">Next</a>
  {% endif %}
</div>
{% endblock %}


